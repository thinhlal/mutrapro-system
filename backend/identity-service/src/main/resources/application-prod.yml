server:
  port: ${SERVER_PORT:8081}
  servlet:
    context-path: ${SERVER_CONTEXT_PATH:} 

spring:
  application:
    name: identity-service
  datasource:
    url: ${DATABASE_URL}
    username: ${DATABASE_USERNAME}
    password: ${DATABASE_PASSWORD}
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false
    open-in-view: false
  sql:
    init:
      mode: never
  data:
    redis:
      host: ${REDIS_HOST}
      port: ${REDIS_PORT}
      password: ${REDIS_PASSWORD}
      timeout: 3000ms
  kafka:
    bootstrap-servers: ${KAFKA_BOOTSTRAP_SERVERS:kafka:9092}
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.springframework.kafka.support.serializer.JsonSerializer

logging:
  level:
    root: INFO
    com.mutrapro.identity_service: DEBUG

# JWT Configuration
jwt:
  signerKey: ${JWT_SIGNER_KEY:QVHfEyXEd7KG4eUfYAWOUvuPjlufU3vImJ0MEialEhHoQPjB6wZTL6Ma9XLnKaYn}
  access-token:
    expiry-seconds: ${ACCESS_TOKEN_EXPIRY_SECONDS:3600}  # 1 hour
  refresh-token:
    expiry-days: ${REFRESH_TOKEN_EXPIRY_DAYS:7}          # 7 days

verification:
  email-otp:
    expiry-seconds: 900
  password-reset:
    expiry-hours: 24

app:
  outbox:
    max-retries: ${OUTBOX_MAX_RETRIES:3}
  event-topics:
    mappings:
      email.verification: ${KAFKA_TOPIC_EMAIL_VERIFICATION:email-verification}
      password.reset: ${KAFKA_TOPIC_PASSWORD_RESET:password-reset}

# Outbound OAuth configuration (prod)
outbound:
  identity:
    client-id: ${GOOGLE_CLIENT_ID}
    client-secret: ${GOOGLE_CLIENT_SECRET}
    redirect-uri: ${GOOGLE_REDIRECT_URI}

# Specialist Service Configuration
specialist:
  service:
    base-url: ${SPECIALIST_SERVICE_BASE_URL:http://specialist-service:8086}

# Management & Actuator
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: when-authorized
      probes:
        enabled: true
  metrics:
    tags:
      application: ${spring.application.name}
    export:
      prometheus:
        enabled: true