// Project Service ERD
// Service: project-service (gộp contract + task + revision + file)
// Database: project_db
// Người 2 (phần còn lại)

// API Examples:
// POST /contracts
//   - Body: { "request_id": "uuid", "user_id": "uuid", "manager_user_id": "uuid" }
//   - Response: { "contract_id": "uuid", "contract_number": "CT-2024-001" }
//
// POST /contracts/{id}/sign
//   - Response: { "contract_id": "uuid", "status": "signed", "signed_at": "2024-01-15T10:30:00Z" }
//
// POST /tasks
//   - Body: { "contract_id": "uuid", "specialist_id": "uuid", "task_type": "transcription" }
//   - Response: { "assignment_id": "uuid", "status": "assigned" }
//
// PATCH /tasks/{id}
//   - Body: { "status": "completed", "notes": "Task completed successfully" }
//   - Response: { "assignment_id": "uuid", "status": "completed" }
//
// POST /revisions
//   - Body: { "contract_id": "uuid", "file_id": "uuid", "requested_by": "uuid", "description": "Need changes" }
//   - Response: { "revision_id": "uuid", "status": "pending" }
//
// PATCH /revisions/{id}
//   - Body: { "status": "approved", "approved_by": "uuid" }
//   - Response: { "revision_id": "uuid", "status": "approved" }
//
// POST /files/upload
//   - Body: { "file_name": "song.mp3", "file_path": "/uploads/song.mp3", "file_size": 5242880, "mime_type": "audio/mpeg" }
//   - Response: { "file_id": "uuid", "file_name": "song.mp3", "status": "uploaded" }
//
// POST /files/{id}/deliver
//   - Body: { "delivered_by": "uuid", "notes": "File delivered to customer" }
//   - Response: { "file_id": "uuid", "delivered_to_customer": true, "delivered_at": "2024-01-15T10:30:00Z" }
//
// POST /projects/{projectId}/files/approve
//   - Body: { "approved_by": "uuid", "notes": "File approved for delivery" }
//   - Response: { "file_id": "uuid", "file_status": "approved" }
//
// Events: contract.signed, milestone.due, task.assigned|completed, revision.approved|completed, file.uploaded, file.delivered, file.approved

Table contracts {
  contract_id uuid [pk, default: `gen_random_uuid()`]
  request_id uuid [not null, note: 'Soft reference to request-service']
  user_id uuid [not null, note: 'Soft reference to identity-service']
  manager_user_id uuid [not null, note: 'Soft reference to identity-service']
  contract_number varchar(50) [unique, not null]
  contract_type contract_type [not null]
  terms_and_conditions text
  special_clauses text
  status contract_status [default: 'draft', not null]
  sent_to_customer_at timestamp
  customer_reviewed_at timestamp
  signed_at timestamp
  deposit_paid_at timestamp
  work_start_at timestamp
  expires_at timestamp
  file_id varchar(36) [note: 'Soft ref to files.file_id (Contract PDF file)']
  notes text

  // Pricing
  total_price decimal(12,2)
  currency currency_type
  deposit_percent decimal(5,2)

  // Timeline & SLA
  expected_start_date timestamp
  sla_days integer
  
  // Revision policy
  free_revisions_included integer [default: 1, not null]
  revision_used_count integer [default: 0, not null]
  additional_revision_fee_vnd decimal(12,2)
  revision_deadline_days integer
  
  // Snapshot thông tin liên hệ từ service_requests (đóng băng pháp lý)
  name_snapshot varchar(255) [not null]
  phone_snapshot varchar(20) [not null]
  email_snapshot varchar(255) [not null]
  
  // Customer action reasons
  cancellation_reason text
  
  // E-Signature fields
  customer_signature_s3_key text
  customer_signed_at timestamp
  
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
  created_by varchar(255)
  updated_by varchar(255)
  
  Note: '[PROJECT SERVICE] Hợp đồng quản lý - Manager tạo hợp đồng trực tiếp từ request với giá tự động. Revision chỉ áp dụng cho transcription và arrangement tasks, không áp dụng cho recording. Snapshot contact info để đóng băng pháp lý. Extends BaseEntity.'
  
  indexes {
    request_id
    user_id
    manager_user_id
    contract_number [unique]
    status
    contract_type
    expires_at
  }
}

Table contract_milestones {
  milestone_id uuid [pk, default: `gen_random_uuid()`]
  contract_id uuid [not null, note: 'Soft ref to contracts.contract_id']
  
  // Thông tin mốc
  name varchar(100) [not null, note: '"Milestone 1: Deposit & Start Arrangement"']
  description text [note: 'Mô tả công việc trong milestone này']
  order_index integer [not null, note: '1, 2, 3... thứ tự milestone']
  
  // Milestone type: để phân biệt milestone là Arrangement hay Recording
  milestone_type milestone_type [note: 'transcription, arrangement, recording - NULL nếu không áp dụng']
  
  // Phần WORK
  work_status milestone_work_status [default: 'planned', not null, note: 'Field name is "work_status", not "status"']
  
  // Payment flag
  has_payment boolean [default: false, not null, note: 'Milestone này có installment tương ứng không']
  
  // SLA và planned dates
  milestone_sla_days integer [note: 'SLA ngày cho milestone này (FE gửi, BE lưu)']
  planned_start_at timestamp [note: 'BE tính khi contract có start date']
  planned_due_date timestamp [note: 'BE tính khi contract có start date (plannedStartAt + milestoneSlaDays)']
  
  // Actual dates
  actual_start_at timestamp [note: 'Ghi nhận thời điểm milestone thực tế bắt đầu']
  actual_end_at timestamp [note: 'Ghi nhận thời điểm milestone thực tế kết thúc']
  first_submission_at timestamp [note: 'Lúc specialist giao bản đầu tiên (để check SLA milestone - KHÔNG thay đổi khi có revision)']
  final_completed_at timestamp [note: 'Lúc customer chấp nhận bản cuối cùng (sau mọi revision)']
  
  // Link với arrangement milestone và submission (cho recording milestone)
  source_arrangement_milestone_id varchar(36) [note: 'ID của arrangement milestone tạo ra recording milestone này']
  source_arrangement_submission_id varchar(36) [note: 'ID của arrangement submission final được dùng để recording']
  
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
  created_by varchar(255)
  updated_by varchar(255)
  
  Note: '[PROJECT SERVICE] Mốc công việc trong hợp đồng - Tách biệt với đợt thanh toán. Extends BaseEntity.'
  
  indexes {
    contract_id
    (contract_id, order_index)
    work_status
    milestone_type
  }
}


Table task_assignments {
  assignment_id uuid [pk, default: `gen_random_uuid()`]
  contract_id uuid [not null, note: 'Soft ref to contracts.contract_id']
  specialist_id uuid [not null, note: 'Soft reference to specialist-service.specialists']
  
  // Specialist snapshots
  specialist_name_snapshot varchar(255)
  specialist_email_snapshot varchar(255)
  specialist_specialization_snapshot varchar(100)
  specialist_experience_years_snapshot integer
  specialist_user_id_snapshot varchar(50)
  
  task_type task_type [not null]
  status assignment_status [default: 'assigned', not null]
  
  // Gán task vào mốc công việc
  milestone_id uuid [not null, note: 'Soft reference to contract_milestones.milestone_id']
  
  // Timeline management
  assigned_date timestamp [default: `now()`, not null]
  completed_date timestamp
  
  notes text
  specialist_response_reason text
  specialist_responded_at timestamp
  
  // Issue reporting (khi specialist báo không kịp deadline)
  has_issue boolean [default: false, not null]
  issue_reason text
  issue_reported_at timestamp
  
  // Link to studio booking (cho recording tasks)
  studio_booking_id uuid [note: 'Soft ref to studio_bookings.booking_id (nullable - có thể null lúc mới tạo task)']
  
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
  created_by varchar(255)
  updated_by varchar(255)
  
  Note: '[PROJECT SERVICE] Phân công task trực tiếp từ contract - Gán vào mốc công việc qua milestone_id. Extends BaseEntity.'
  
  indexes {
    contract_id
    specialist_id
    milestone_id
    (milestone_id, contract_id)
    status
    task_type
  }
}

Table revision_requests {
  revision_request_id uuid [pk, default: `gen_random_uuid()`]
  
  // ID & quan hệ
  contract_id uuid [not null, note: 'Soft ref to contracts.contract_id']
  milestone_id uuid [note: 'Soft ref to contract_milestones.milestone_id']
  task_assignment_id uuid [note: 'Soft ref to task_assignments.assignment_id']
  original_submission_id uuid [note: 'Soft ref to file_submissions.submission_id - Submission ban đầu mà customer request revision']
  revised_submission_id uuid [note: 'Soft ref to file_submissions.submission_id - Submission mới sau khi specialist làm lại']
  customer_id uuid [not null, note: 'Soft ref to identity-service.users_auth']
  manager_id uuid [note: 'Soft ref to identity-service.users_auth']
  specialist_id uuid [note: 'Soft ref to specialist-service.specialists - Set khi approve hoặc lấy từ task']
  
  // Nội dung business
  title varchar(255) [not null, note: 'Tiêu đề ngắn yêu cầu revision']
  description text [not null, note: 'Mô tả chi tiết yêu cầu của customer']
  manager_note text [note: 'Ghi chú khi Manager approve / reject']
  specialist_note text [note: 'Ghi chú từ Specialist (optional)']
  paid_wallet_tx_id uuid [note: 'Soft ref to billing-service.wallet_transactions.wallet_tx_id - ID transaction ví nếu là paid revision']
  revision_round integer [not null, note: 'Lần revision thứ mấy cho task/milestone này (1,2,3...)']
  is_free_revision boolean [default: true, not null, note: 'Nếu vẫn muốn count số lượt revision free']
  
  // Status
  status revision_status [default: 'pending_manager_review', not null]
  
  // Thời gian & audit
  requested_at timestamp [not null, note: 'Lúc customer gửi']
  manager_reviewed_at timestamp [note: 'Lúc Manager approve/reject']
  revision_due_at timestamp [note: 'Deadline phải giao xong revision (managerReviewedAt + revisionDeadlineDays)']
  assigned_to_specialist_at timestamp [note: 'Lúc giao cho Specialist']
  specialist_submitted_at timestamp [note: 'Lúc Specialist hoàn thành bản revised']
  customer_confirmed_at timestamp [note: 'Lúc customer confirm xong']
  canceled_at timestamp [note: 'Lúc bị hủy (nếu có)']
  
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
  created_by varchar(255)
  updated_by varchar(255)
  
  Note: '[PROJECT SERVICE] Yêu cầu chỉnh sửa - Manager duyệt revision trước khi specialist thực hiện. Extends BaseEntity.'
  
  indexes {
    contract_id
    milestone_id
    task_assignment_id
    original_submission_id
    revised_submission_id
    customer_id
    manager_id
    specialist_id
    status
    (task_assignment_id, revision_round)
    paid_wallet_tx_id
  }
}

Table studios {
  studio_id uuid [pk, default: `gen_random_uuid()`]
  studio_name varchar(100) [not null, default: 'MuTraPro Studio']
  location varchar(255) [not null]
  hourly_rate decimal(10,2) [default: 200000]
  free_external_guests_limit integer [default: 3]
  extra_guest_fee_per_person decimal(12,2) [default: 50000]
  is_active boolean [default: true]
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
  created_by varchar(255)
  updated_by varchar(255)
  
  Note: '[PROJECT SERVICE] Studio information - Single studio system'
  
  indexes {
    is_active
  }
}

Table studio_bookings {
  booking_id uuid [pk, default: `gen_random_uuid()`]
  user_id uuid [not null, note: 'Soft ref to identity-service.users_auth']
  studio_id uuid [ref: > studios.studio_id, not null]
  request_id uuid [note: 'Soft ref to request-service.service_requests']
  contract_id uuid [note: 'Soft ref to contracts.contract_id']
  milestone_id uuid [note: 'Soft ref to contract_milestones.milestone_id']
  context studio_booking_context [not null]
  session_type recording_session_type [not null]
  booking_date date [not null]
  start_time time [not null]
  end_time time [not null]
  status booking_status [default: 'tentative']
  hold_expires_at timestamp
  external_guest_count integer [default: 0]
  duration_hours decimal(5,2) [not null]
  artist_fee decimal(12,2) [default: 0]
  equipment_rental_fee decimal(12,2) [default: 0]
  external_guest_fee decimal(12,2) [default: 0]
  total_cost decimal(12,2) [default: 0]
  purpose text
  special_instructions text
  notes text
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
  created_by varchar(255)
  updated_by varchar(255)
  
  Note: '[PROJECT SERVICE] Studio booking sessions - 1:N với studios'
  
  indexes {
    user_id
    studio_id
    request_id
    contract_id
    milestone_id
    context
    session_type
    booking_date
    status
  }
}

Table booking_artists {
  booking_artist_id uuid [pk, default: `gen_random_uuid()`]
  booking_id uuid [ref: > studio_bookings.booking_id, not null]
  specialist_id uuid [not null, note: 'Soft ref to specialist-service.specialists']
  role varchar(50) [note: 'PRIMARY_VOCALIST, GUITARIST, PRODUCER, ENGINEER, VOCALIST, etc.']
  is_primary boolean [default: false, note: 'true nếu là artist chính (vocal chính)']
  artist_fee decimal(12,2) [default: 0, note: 'Phí cho artist này (optional)']
  skill_id uuid [note: 'Soft ref to specialist-service.skills.skill_id']
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
  created_by varchar(255)
  updated_by varchar(255)
  
  Note: '[PROJECT SERVICE] Artists for booking - 1:N với studio_bookings'
  
  indexes {
    booking_id
    specialist_id
    (booking_id, specialist_id) [unique]
  }
}

Table booking_participants {
  participant_id uuid [pk, default: `gen_random_uuid()`]
  booking_id uuid [ref: > studio_bookings.booking_id, not null]
  role_type session_role_type [not null, note: 'VOCAL | INSTRUMENT']
  performer_source performer_source [not null, note: 'CUSTOMER_SELF | INTERNAL_ARTIST']
  specialist_id varchar(36) [note: 'Soft ref to specialist-service.specialists (nếu INTERNAL_ARTIST)']
  skill_id varchar(36) [note: 'Soft ref to specialist-service.skills (CHỈ CHO INSTRUMENT, BẮT BUỘC)']
  instrument_source instrument_source [note: 'STUDIO_SIDE | CUSTOMER_SIDE (chỉ cho INSTRUMENT)']
  equipment_id varchar(36) [note: 'Soft ref to equipment.equipment_id (nếu STUDIO_SIDE)']
  participant_fee decimal(12,2) [default: 0, note: 'CHỈ fee của performer, KHÔNG bao gồm equipment rental']
  is_primary boolean [default: false]
  notes text
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
  created_by varchar(255)
  updated_by varchar(255)
  
  Note: '[PROJECT SERVICE] Participants in booking session - 1:N với studio_bookings'
  
  indexes {
    booking_id
    skill_id
    specialist_id
    equipment_id
  }
}

Table booking_required_equipment {
  booking_equipment_id uuid [pk, default: `gen_random_uuid()`]
  booking_id uuid [ref: > studio_bookings.booking_id, not null]
  equipment_id varchar(36) [not null, note: 'Soft ref to equipment.equipment_id (same service)']
  quantity integer [default: 1]
  rental_fee_per_unit decimal(12,2) [not null]
  total_rental_fee decimal(12,2) [not null]
  participant_id uuid [note: 'Soft ref to booking_participants.participant_id']
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
  created_by varchar(255)
  updated_by varchar(255)
  
  Note: '[PROJECT SERVICE] Equipment for booking - 1:N với studio_bookings, soft ref to equipment'
  
  indexes {
    booking_id
    equipment_id
    participant_id
    (booking_id, equipment_id) [unique]
  }
}

Table equipment {
  equipment_id uuid [pk, default: `gen_random_uuid()`]
  equipment_name varchar(100) [not null]
  brand varchar(50)
  model varchar(100)
  description text
  specifications jsonb
  rental_fee decimal(12,2) [default: 0]
  total_quantity integer [default: 1]
  is_active boolean [default: true]
  image varchar(500)
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
  created_by varchar(255)
  updated_by varchar(255)
  
  Note: '[PROJECT SERVICE] Equipment catalog'
  
  indexes {
    equipment_name
    brand
    model
    (brand, model) [unique]
    is_active
  }
}

Table skill_equipment_mapping {
  mapping_id uuid [pk, default: `gen_random_uuid()`]
  skill_id uuid [not null, note: 'Soft ref to specialist-service.skills.skill_id']
  equipment_id uuid [ref: > equipment.equipment_id, not null]
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
  created_by varchar(255)
  updated_by varchar(255)
  
  Note: '[PROJECT SERVICE] Mapping skills to equipment - Many-to-Many: Skill ↔ Equipment'
  
  indexes {
    skill_id
    equipment_id
    (skill_id, equipment_id) [unique]
  }
}

Table contract_installments {
  installment_id uuid [pk, default: `gen_random_uuid()`]
  contract_id uuid [not null, note: 'Soft ref to contracts.contract_id']
  type installment_type [not null, default: 'deposit']
  milestone_id varchar(36) [note: 'NULL cho DEPOSIT, gắn với milestone cho các type khác']
  label varchar(100) [not null, note: '"Deposit", "Milestone 1 Payment", etc.']
  percent decimal(5,2) [note: 'NULL cho EXTRA_REVISION, có giá trị cho các type khác']
  due_date timestamp
  amount decimal(12,2) [not null]
  currency currency_type [default: 'VND']
  status installment_status [default: 'pending']
  gate_condition gate_condition [default: 'before_start']
  paid_at timestamp
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
  created_by varchar(255)
  updated_by varchar(255)
  
  Note: '[PROJECT SERVICE] Payment installments for contracts'
  
  indexes {
    contract_id
    status
    type
    milestone_id
  }
}

Table contract_sign_sessions {
  session_id uuid [pk, default: `gen_random_uuid()`]
  contract_id varchar(36) [not null, note: 'Soft ref to contracts.contract_id']
  user_id varchar(36) [not null, note: 'Soft ref to identity-service.users_auth']
  signature_temp_base64 text
  otp_code varchar(10) [not null]
  expire_at timestamp [not null]
  attempt_count integer [default: 0, not null]
  status sign_session_status [default: 'pending', not null]
  created_at timestamp [not null, default: `now()`]
  updated_at timestamp
  
  Note: '[PROJECT SERVICE] E-signature sessions for contracts - Does NOT extend BaseEntity'
  
  indexes {
    contract_id
    user_id
    expire_at
    status
  }
}

Table file_submissions {
  submission_id uuid [pk, default: `gen_random_uuid()`]
  assignment_id uuid [not null, note: 'Soft ref to task_assignments.assignment_id']
  revision_request_id uuid [note: 'Soft ref to revision_requests.revision_request_id']
  submission_name varchar(255)
  status submission_status [default: 'draft', not null]
  created_by varchar(255) [not null, note: 'Soft ref to identity-service']
  created_at timestamp [not null, default: `now()`]
  submitted_at timestamp
  reviewed_by varchar(255) [note: 'Soft ref to identity-service']
  reviewed_at timestamp
  rejection_reason text
  version integer
  
  Note: '[PROJECT SERVICE] File submissions - Does NOT extend BaseEntity'
  
  indexes {
    assignment_id
    revision_request_id
    created_by
    status
    submitted_at
  }
}

Table files {
  file_id uuid [pk, default: `gen_random_uuid()`]
  
  // Source references (one of these will be NULL)
  request_id uuid [note: 'Soft reference to request-service']
  assignment_id uuid [note: 'Soft reference to task_assignments.assignment_id']
  submission_id uuid [note: 'Soft reference to file_submissions.submission_id (optional - file có thể thuộc submission package)']
  booking_id uuid [note: 'Soft reference to studio_bookings.booking_id']
  
  // File metadata
  file_name varchar(255) [not null]
  file_key_s3 varchar(500) [not null, note: 'S3 object key (e.g., "task-outputs/123/file-uuid.pdf"), not URL']
  file_size bigint [not null]
  mime_type varchar(100)   
  
  // File classification
  file_source file_source_type [not null]
  content_type content_type [not null]
  
  // General metadata
  description text
  upload_date timestamp [not null]
  created_by uuid [not null, note: 'Soft reference to identity-service']
  
  // Delivery tracking
  delivered_to_customer boolean [default: false, not null]
  delivered_at timestamp
  delivered_by uuid [note: 'Soft reference to identity-service']
  
  // File status tracking
  file_status file_status [default: 'uploaded', not null]
  rejection_reason text
  reviewed_by uuid [note: 'Soft reference to identity-service']
  reviewed_at timestamp
  created_at timestamp [default: `now()`]
  updated_at timestamp [default: `now()`]
  created_by_audit varchar(255)
  updated_by_audit varchar(255)
  
  Note: '[PROJECT SERVICE] Quản lý tất cả files trong hệ thống. Enhanced với notation editor và AI support.'
  
  indexes {
    request_id
    assignment_id
    submission_id
    booking_id
    file_source
    content_type
    created_by
    upload_date
    delivered_to_customer
    delivered_at
    delivered_by
    file_status
    reviewed_by
    reviewed_at
  }
}

Table outbox_events {
  event_id uuid [pk, default: `gen_random_uuid()`]
  aggregate_id uuid [not null]
  aggregate_type text [not null]
  event_type text [not null]
  event_payload jsonb [not null]
  occurred_at timestamptz [not null, default: `now()`]
  published_at timestamptz
  retry_count integer [not null, default: 0]
  last_error text
  next_retry_at timestamptz
  trace_id text
  correlation_id text
  
  Note: 'Event publishing'
  
  indexes {
    aggregate_id
    aggregate_type
    event_type
    occurred_at
    (next_retry_at)
  }
}

Table consumed_events {
  event_id uuid [not null]
  consumer_name text [not null]
  processed_at timestamptz [not null, default: `now()`]
  
  Note: 'Idempotency - PK(event_id, consumer_name), INSERT ... ON CONFLICT DO NOTHING'
  
  indexes {
    (event_id, consumer_name) [unique, pk]
    consumer_name
    processed_at
  }
}

// Enums
Enum contract_type {
  transcription
  arrangement
  arrangement_with_recording
  recording
}

Enum contract_status {
  draft
  sent_to_customer
  customer_reviewing
  signed
  expired
  cancelled
}

Enum milestone_type {
  transcription
  arrangement
  recording
}

Enum milestone_work_status {
  planned
  in_progress
  completed
  cancelled
}

Enum task_type {
  transcription
  arrangement
  recording
}

Enum assignment_status {
  assigned
  in_progress
  completed
  cancelled
}

Enum revision_status {
  pending_manager_review
  approved
  rejected
  assigned_to_specialist
  in_progress
  specialist_submitted
  customer_confirmed
  cancelled
}

Enum payment_status {
  not_required
  pending
  processing
  completed
  failed
  refunded
  cancelled
}

Enum currency_type {
  VND
  USD
  EUR
}

// File Management Enums (MOVED FROM file-service)
Enum file_source_type {
  customer_upload
  task_deliverable
  studio_recording
}

Enum content_type {
  audio
  sheet_music
  project_file
  documentation
  video
  archive
}

Enum file_status {
  uploaded
  pending_review
  approved
  rejected
  delivered
  revision_requested
}

Enum studio_booking_context {
  contract_recording
  standalone_booking
  pre_contract_hold
}

Enum recording_session_type {
  vocal_only
  instrument_only
  both
}

Enum booking_status {
  tentative
  confirmed
  in_progress
  completed
  cancelled
  no_show
}

Enum session_role_type {
  vocal
  instrument
}

Enum performer_source {
  customer_self
  internal_artist
}

Enum instrument_source {
  studio_side
  customer_side
}

Enum installment_type {
  deposit
  milestone_payment
  extra_revision
}

Enum installment_status {
  pending
  paid
  overdue
  cancelled
}

Enum gate_condition {
  before_start
  after_start
  on_deliverable
  on_completion
}

Enum sign_session_status {
  pending
  verified
  expired
  failed
}

Enum submission_status {
  draft
  submitted
  approved
  rejected
}

Enum milestone_work_status {
  planned
  in_progress
  completed
  cancelled
}